<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="data:application/manifest+json,{'name':'PrecuApp','display':'standalone','background_color':'#d1d1d1'}">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
<link rel="manifest" href="favicon_io/site.webmanifest">
    
    <title>PrecuApp</title>
    <style>
        :root {
            --bg-main: #d1d1d1; /* El gris de fondo de tu imagen */
            --card-bg: #e0e0e0;
            --accent: #007aff;
            --safe-bottom: env(safe-area-inset-bottom);
        }

        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: white; overflow: hidden; }

        .app-container { width: 100%; max-width: 430px; height: 100vh; margin: 0 auto; display: flex; align-items: center; justify-content: center; background: #fff; }

        .screen { 
            position: absolute; width: 90%; max-width: 380px; 
            background: var(--bg-main); border-radius: 50px; 
            padding: 30px 20px; box-sizing: border-box;
            display: flex; flex-direction: column; align-items: center;
            transition: 0.4s ease; visibility: hidden; opacity: 0;
        }
        .screen.active { visibility: visible; opacity: 1; }

        h2 { font-size: 24px; font-weight: 700; margin-top: 0; margin-bottom: 20px; color: #000; }

        /* --- Zona de Foto --- */
        .photo-placeholder {
            width: 100%; height: 150px; background: #bdbdbd; border-radius: 25px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: #666; cursor: pointer; margin-bottom: 20px;
        }

        /* --- Input Estilo Imagen --- */
        .input-group { width: 100%; margin-bottom: 20px; }
        input[type="text"], input[type="date"], input[type="number"] {
            width: 100%; background: transparent; border: none;
            border-bottom: 2px solid #9e9e9e; font-size: 20px; padding: 10px 0;
            outline: none; color: #333;
        }

        /* --- Chips de Actividad --- */
        .chips-container { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-bottom: 30px; }
        .chip {
            background: white; padding: 10px 18px; border-radius: 25px;
            font-size: 14px; font-weight: 500; color: #000; cursor: pointer;
            transition: all 0.2s; border: 2px solid transparent;
        }
        .chip.selected { background: var(--accent); color: white; }

        /* --- Botón Continuar --- */
        .btn-continue {
            width: 100%; background: white; border-radius: 30px; padding: 18px;
            border: none; font-size: 20px; font-weight: 600; color: #000;
            cursor: pointer; margin-top: auto;
        }

        /* Pantalla 2: Horas */
        .hour-display { font-size: 80px; font-weight: 800; background: transparent; border: none; text-align: center; width: 150px; }
        .controls { display: flex; align-items: center; gap: 30px; margin: 40px 0; }
        .btn-circle { width: 60px; height: 60px; border-radius: 50%; background: #bdbdbd; border: none; font-size: 30px; cursor: pointer; }

        /* Pantalla 3: Resumen */
        .mini-card { background: white; border-radius: 20px; padding: 15px; width: 100%; margin-bottom: 10px; }
        .progress-bg { background: #eee; height: 8px; border-radius: 4px; overflow: hidden; margin-top: 8px; }
        .progress-fill { background: var(--accent); height: 100%; width: 0%; transition: 0.5s; }
    </style>
</head>
<body>

<div class="app-container">
    
    <section id="screen1" class="screen active">
        <h2>Datos de la actividad</h2>
        
        <div class="photo-placeholder" onclick="alert('Cámara no disponible en este demo')">
            <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
            <span>Añadir una foto</span>
        </div>

        <div class="input-group">
            <input type="text" id="act-name" placeholder="Nombre">
        </div>

        <div class="chips-container">
            <div class="chip" onclick="selectChip(this)">Casa en casa</div>
            <div class="chip" onclick="selectChip(this)">Informal</div>
            <div class="chip" onclick="selectChip(this)">Estudio</div>
            <div class="chip" onclick="selectChip(this)">Carrito</div>
            <div class="chip" onclick="selectChip(this)">Revisita</div>
            <div class="chip" style="background:#000; color:#fff" onclick="nav(4)">Ajuste Mes</div>
        </div>

        <button class="btn-continue" onclick="nav(2)">Continuar</button>
    </section>

    <section id="screen2" class="screen">
        <h2>¿Cuántas horas?</h2>
        <div class="controls">
            <button class="btn-circle" onclick="modH(-1)">-</button>
            <input type="number" id="hour-input" class="hour-display" value="1" inputmode="numeric">
            <button class="btn-circle" onclick="modH(1)">+</button>
        </div>
        <button class="btn-continue" onclick="save()">Confirmar</button>
    </section>

    <section id="screen3" class="screen">
        <h2>Resumen</h2>
        <div class="mini-card">
            <div style="display:flex; justify-content:space-between"><span>Mes</span><strong id="txt-m">0/50</strong></div>
            <div class="progress-bg"><div id="bar-m" class="progress-fill"></div></div>
        </div>
        <div class="mini-card">
            <div style="display:flex; justify-content:space-between"><span>Año</span><strong id="txt-y">0/600</strong></div>
            <div class="progress-bg"><div id="bar-y" class="progress-fill" style="background:#34c759"></div></div>
        </div>
        <button class="btn-continue" onclick="location.reload()">Nuevo Registro</button>
    </section>

    <section id="screen4" class="screen">
        <h2>Elegir Mes</h2>
        <div class="chips-container" id="month-grid"></div>
        <button class="btn-continue" onclick="nav(2)">Siguiente</button>
    </section>

</div>

<script>
    let db = JSON.parse(localStorage.getItem('db_v20')) || [];
    let cur = { name: '', hrs: 1, ms: Date.now() };

    // Generar Meses
    const meses = ["Sep 25", "Oct 25", "Nov 25", "Dic 25", "Ene 26", "Feb 26", "Mar 26", "Abr 26", "May 26", "Jun 26", "Jul 26", "Ago 26"];
    const grid = document.getElementById('month-grid');
    meses.forEach(m => {
        grid.innerHTML += `<div class="chip" onclick="selectMonth(this, '${m}')">${m}</div>`;
    });

    function selectChip(el) {
        document.querySelectorAll('.chip').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        document.getElementById('act-name').value = el.innerText;
    }

    function selectMonth(el, m) {
        document.querySelectorAll('#month-grid .chip').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        cur.name = "Total " + m;
        cur.ms = new Date(2025, 8, 1).getTime(); // Simplificado para el ejemplo
    }

    function nav(n) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById('screen'+n).classList.add('active');
    }

    function modH(v) { 
        let inp = document.getElementById('hour-input');
        inp.value = Math.max(0, parseInt(inp.value) + v);
    }

    function save() {
        cur.name = document.getElementById('act-name').value || cur.name || 'Servicio';
        cur.hrs = parseInt(document.getElementById('hour-input').value);
        db.push({...cur});
        localStorage.setItem('db_v20', JSON.stringify(db));
        updateUI();
        nav(3);
    }

    function updateUI() {
        let totalY = db.reduce((a, b) => a + b.hrs, 0);
        document.getElementById('txt-y').innerText = totalY + '/600h';
        document.getElementById('bar-y').style.width = (totalY/600*100) + '%';
        document.getElementById('txt-m').innerText = (totalY % 50) + '/50h'; // Ejemplo
        document.getElementById('bar-m').style.width = ((totalY % 50)/50*100) + '%';
    }
</script>
</body>
</html>
